# miRFA

MiRFA is a pipeline built for functional analysis of a mature miRNA in a pancreatic cancer context. The pipeline automatically performs the following steps:

1) MiRNA target prediction


2) Correlation analyses between miRNA-target genes on mRNA and protein expression levels

3) Functional enrichment of significantly correlated targets on mRNA and protein expression levels

## Getting started

The pipeline requires the following packages to function:

- org.Hs.eg.db
- GO.db
- edgeR
- argparser
- DBI
- RSQLite
- VennDiagram
- gridExtra

The packages can be installed with the following code:
``` R
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install(c("org.Hs.eg.db",
                       "GO.db",
                       "edgeR"),
                     version = "3.8")
```

```R
install.packages(c("argparser",
                   "DBI",
                   "RSQLite",
                   "VennDiagram",
                   "gridExtra"))
```

### Installing

Clone or download the repository, install the package dependencies if needed and the miRNA database in the database folder. The database first needs to be downloaded from onedrive (requires Microsoft account) using the following link:

https://1drv.ms/u/s!Ap_ICu6nvktNgW6Y68Zkp1HTx0vE

## Running the pipeline
The pipeline is executed on the command line with the script run_pipeline.R that can be found in the pipeline folder.
It takes one required and one 1 optional argument.

The required argument is an input file in the format of text file with one mature miRNA per line.  Notice that the input miRNA has to be a mature miRNA name, e.g. 'hsa-miR-885-5p'.

The optional argument, -n,  is a name for the run, the results will be stored in the results folder under results/run_name. If no argument is given the run_name will be the filename of the input file.

### Demo run

There is an example input file included under data/demo_input.txt. To run the example:

```bash
Rscript run_pipeline.R ../data/demo_input.txt -n testrun
```

### Output

The following files are generated by the pipeline and be found under results/run_name:

1. Tarbase miRNA target genes
2. TargetScan miRNA target genes
3. DIANA-microT-CDS miRNA target genes
4. Union of miRNA target genes (1-3)
5. A Venn Diagram showing the overlap of miRNA target genes generated from the target prediction databases
6. Positive, significant correlations on mRNA expression levels between the miRNA and its predicted target.
7. Negative, significant correlations on mRNA expression levels between the miRNA and its predicted target.
8. Positive, significant correlations on protein expression levels between the miRNA and its predicted target.
9. Negative, significant correlations on protein expression levels between the miRNA and its predicted target.
10. Significant correlations on both mRNA and protein expression levels between the miRNA and its predicted target.
11. Significantly enriched GO terms.
12. Significantly enriched KEGG pathways.
