# miRFA

MiRFA is a pipeline built for functional analysis of a mature miRNA in a pancreatic cancer context. The pipeline automatically performs the following steps:

1) MiRNA target prediction


2) Correlation analyses between miRNA-target genes on mRNA and protein expression levels

3) Functional enrichment of significantly correlated targets on mRNA and protein expression levels

## Getting started

The pipeline requires the following packages to function:

- org.Hs.eg.db
- GO.db
- edgeR
- argparser
- DBI
- RSQLite
- VennDiagram
- gridExtra

The packages can be installed with the following code:
``` R
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install(c("org.Hs.eg.db",
                       "GO.db",
                       "edgeR"),
                     version = "3.8")
```

```R
install.packages(c("argparser",
                   "DBI",
                   "RSQLite",
                   "VennDiagram",
                   "gridExtra"))
```

### Installing

Clone or download the repository, install the package dependencies if needed and download the miRNA database and put it in the database folder. The database first needs to be downloaded from OneDrive using the following link:

[https://1drv.ms/u/s!Ap_ICu6nvktNgW6Y68Zkp1HTx0vE](https://umeauniversity-my.sharepoint.com/:u:/g/personal/embo0061_ad_umu_se/EVlUcYg7CP1KoJF17w_p8CUBJZVAepXeyhk-Tv8aB0cmTQ?e=Qg6118)

## Running the pipeline
The pipeline is executed on the command line with the script run_pipeline.R that can be found in the main miRFA folder.
It takes one required and three optional arguments.

The required argument is an input file in the format of text file with one mature miRNA per line.  Notice that the input miRNA has to be a mature miRNA name, e.g. 'hsa-miR-885-5p'.

The first optional argument, -n,  is a name for the run, the results will be stored in the results folder under results/run_name. If no argument is given the run_name will be the filename of the input file.

The second optional argument, -g, is the minimum number of genes for enrichment. When this argument is not given it defaults to 5

The third optional argument, -t, is the threshold for microt-CDS. It should be between 0 and 1. When this argument is not given if defaults to 0.7

### Demo run

There is an example input file included under data/demo_input.txt. To run the example with all parameters:

```bash
Rscript run_pipeline.R data/demo_input.txt -n testrun -g 4 -t 0.8
```

### Output

The following files are generated by the pipeline and be found under results/run_name:

1. Tarbase miRNA target genes
2. TargetScan miRNA target genes
3. DIANA-microT-CDS miRNA target genes
4. Union of miRNA target genes (1-3)
5. A Venn Diagram showing the overlap of miRNA target genes generated from the target prediction databases
6. Positive, significant correlations on mRNA expression levels between the miRNA and its predicted target.
7. Negative, significant correlations on mRNA expression levels between the miRNA and its predicted target.
8. Positive, significant correlations on protein expression levels between the miRNA and its predicted target.
9. Negative, significant correlations on protein expression levels between the miRNA and its predicted target.
10. Significant correlations on both mRNA and protein expression levels between the miRNA and its predicted target.
11. Significantly enriched GO terms.
12. Significantly enriched KEGG pathways.
